```markdown:d:/github_agentcp/samples/hcp/README.md
# æ™ºèƒ½å¤©æ°”åŠ©æ‰‹ï¼ˆHCPï¼‰

åŸºäºŽ agentcp æ¡†æž¶å¼€å‘çš„æ™ºèƒ½å¤©æ°”åŠ©æ‰‹ï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€äº¤äº’å’Œä¸Šä¸‹æ–‡è®°å¿†ï¼Œèƒ½å¤Ÿå°†ç”¨æˆ·ä½œä¸ºå¤–éƒ¨å·¥å…·å›žè°ƒèŽ·å–å¿…è¦ä¿¡æ¯ã€‚

## ðŸš€ ä½¿ç”¨æŒ‡å—

1. **åˆ›å»ºagentèº«ä»½(aid)**
   - å‚è€ƒæ–‡æ¡£ï¼šåˆ›å»ºèº«ä»½&è¯»å†™å…¬ç§æœ‰æ•°æ®

2. **é…ç½®Agentå‚æ•°**
   ```python:hcp.py
   # ä¿®æ”¹hcp.pyä¸­çš„agent_idé…ç½®é¡¹
   agent_id = "your_agent_id"  # æ›¿æ¢ä¸ºå®žé™…åˆ›å»ºçš„aid
   ```

3. **é…ç½®çŽ¯å¢ƒå˜é‡**
   ```bash:.env
   OPENAI_API_KEY=your_api_key
   BASE_URL=https://api.openai.com/v1
   MODEL=gpt-3.5-turbo
   ```

4. **å®‰è£…ä¾èµ–**
   ```bash
   pip install openai agentcp python-dotenv
   ```

5. **å¯åŠ¨æœåŠ¡**
   ```bash
   python hcp.py
   ```

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

- ðŸŒ¦ï¸ å¤šç»´åº¦å¤©æ°”æŸ¥è¯¢ï¼ˆå½“å‰å¤©æ°”/åŽ†å²å¤©æ°”/å¤©æ°”é¢„æŠ¥ï¼‰
- ðŸ—£ï¸ ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„å¯¹è¯ç®¡ç†
- ðŸ”§ å¤–éƒ¨å·¥å…·å›žè°ƒæœºåˆ¶ï¼ˆç”¨äºŽèŽ·å–ç¼ºå¤±çš„ä½ç½®/æ—¶é—´ä¿¡æ¯ï¼‰
- â° è‡ªåŠ¨æ—¶é—´æŽ¨ç†ï¼ˆæ”¯æŒç»å¯¹æ—¶é—´ã€ç›¸å¯¹æ—¶é—´å’Œå¹´å·çºªå¹´ï¼‰

## ðŸ§© æ ¸å¿ƒç±»è¯´æ˜Žï¼šMCPClient

### åˆå§‹åŒ–æ–¹æ³•
```python
def __init__(self):
    # åˆå§‹åŒ– OpenAI å®¢æˆ·ç«¯
    self.client = OpenAI(api_key=os.getenv("OPENAI_API_KEY"))
    # åˆ›å»º AgentCP å®žä¾‹
    self.acp = agentcp.AgentCP(app_path)
    # æ¶ˆæ¯å­˜å‚¨å™¨ï¼ˆæŒ‰ session_id éš”ç¦»ï¼‰
    self.message_store = dict()
```

### æ¶ˆæ¯ç®¡ç†æœºåˆ¶
```python
def record_message(self, session_id: str, role: str, content: str):
    # è®°å½•å¯¹è¯åŽ†å²ï¼ˆæ”¯æŒ user/assistant/system ä¸‰ç§è§’è‰²ï¼‰

def get_messages_for_llm(self, session_id: str, max_messages=20, system_message=None):
    # æž„é€ ç¬¦åˆ OpenAI æ ¼å¼çš„å¯¹è¯åŽ†å²ï¼ˆè‡ªåŠ¨ç»´æŠ¤æœ€è¿‘20æ¡æ¶ˆæ¯ï¼‰
```

## ðŸ”„ äº¤äº’æµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·æé—®] --> B{æ˜¯å¦å¤©æ°”ç›¸å…³?}
    B -->|æ˜¯| C[æ£€æŸ¥ä½ç½®/æ—¶é—´ä¿¡æ¯]
    B -->|å¦| D[ç®€çŸ­å›žç­”å¹¶å¼•å¯¼]
    C --> E{ä¿¡æ¯å®Œæ•´?}
    E -->|æ˜¯| F[ç”Ÿæˆå¤©æ°”æŠ¥å‘Š]
    E -->|å¦| G[è°ƒç”¨ç”¨æˆ·å·¥å…·èŽ·å–ä¿¡æ¯]
```

## ðŸ’¬ ç¤ºä¾‹å¯¹è¯

> **ç”¨æˆ·**ï¼šæ˜Žå¤©å¤©æ°”æ€Žä¹ˆæ ·  
> **Agent**ï¼šä½ æƒ³æŸ¥è¯¢å“ªé‡Œçš„å¤©æ°”å‘¢  
> **ç”¨æˆ·**ï¼šä¸Šæµ·  
> **Agent**ï¼šä¸Šæµ·çš„å¤©æ°”æ™´  
> **ç”¨æˆ·**ï¼šä¸Šæµ·  
> **Agent**ï¼šä½ æ˜¯æƒ³æŸ¥è¯¢ä¸Šæµ·ä»€ä¹ˆæ—¶å€™çš„å¤©æ°”å‘¢
```

        